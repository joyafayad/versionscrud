@using VersionsCRUD.Project
@model ProjectGetResp
<link rel="stylesheet" href=@Url.Content("~/assets/css/site.css") type="text/css" asp-append-version="true" />


<div class="row">
	<div class="col-md-6">
		<a href="/api/Project/Create" class="Add">Add</a>
	</div>
</div>


<table id="example" class="table table-striped table-bordered">
	<thead>
		<tr>
			
			<th>Project Name</th>
			<th> Action</th>
			
		</tr>
	</thead>
	<tbody id="table-body">
		@{
			var tableData = Model.projects;
			
			
		}
			@foreach (var project in Model.projects)
			{
			<tr>
				<td>@project.name</td>
				<td>
					<button onclick="deleteProject('@project.id')">
						<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
							<path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
						</svg>
					</button>

					<a href="/api/Project/Edit?id=@project.id">
					<button>	
						<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
							<path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-2-9-9-2-9 2 2 9 9 2zm0 0v-8m-4 4h8" />
						</svg>
					</button>
					</a>
				</td>
			</tr>
			}
	</tbody>
		
	
</table>

@* <script src="@Url.Content("~/assets/js/Project/main.js")"></script> *@
@section scripts {
	<script>
		$(document).ready(function () {
			$('#example').DataTable();
		});

		
			function deleteProject(projectId) {
				$.ajax({
					url: '/api/Project/Delete', 
					type: 'POST',
					contentType: 'application/json',
					data: JSON.stringify({ id: projectId }), // Send project ID as JSON object
				success: function (result) {  
					console.log(result);
					alert(result.message);
					location.reload(); 
				},
				error: function (xhr, status, error) {

					console.error(xhr.responseText);

					alert('Error deleting project: ' + xhr.responseText);
				}
				// success: function (result) {
				// 	console.log(result);
				// 	ShowPopup(result.message, 'success');
				// 	location.reload(); 
				// },
				// error: function (xhr, status, error) {
				// 	console.error(xhr.responseText);
				// 	ShowPopup('Error deleting project: ' + xhr.responseText, 'error');
				// }
				});
			}

		// function ShowPopup(message, type) {
		// 	var popup = document.getElementById('popupModal');
		// 	var popupMessage = document.getElementById('popupMessage');
		// 	popupMessage.innerHTML = message;

			
		// 	if (type === 'success') {
		// 		popupMessage.classList.add('success-message');
		// 	} else {
		// 		popupMessage.classList.add('error-message');
		// 	}

			
		// 	popup.style.display = 'block';


	</script>
}